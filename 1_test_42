Pretrained
  0%|          | 0/50 [00:00<?, ?batch/s]  2%|▏         | 1/50 [00:03<02:35,  3.16s/batch]  4%|▍         | 2/50 [00:03<01:13,  1.53s/batch]  6%|▌         | 3/50 [00:03<00:47,  1.02s/batch]  8%|▊         | 4/50 [00:04<00:35,  1.29batch/s] 10%|█         | 5/50 [00:04<00:28,  1.56batch/s] 12%|█▏        | 6/50 [00:05<00:24,  1.83batch/s] 14%|█▍        | 7/50 [00:05<00:20,  2.06batch/s] 16%|█▌        | 8/50 [00:05<00:18,  2.24batch/s] 18%|█▊        | 9/50 [00:06<00:17,  2.33batch/s] 20%|██        | 10/50 [00:06<00:16,  2.44batch/s] 22%|██▏       | 11/50 [00:06<00:15,  2.49batch/s] 24%|██▍       | 12/50 [00:07<00:14,  2.55batch/s] 26%|██▌       | 13/50 [00:07<00:15,  2.47batch/s] 28%|██▊       | 14/50 [00:08<00:14,  2.44batch/s] 30%|███       | 15/50 [00:08<00:13,  2.51batch/s] 32%|███▏      | 16/50 [00:08<00:13,  2.59batch/s] 34%|███▍      | 17/50 [00:09<00:12,  2.61batch/s] 36%|███▌      | 18/50 [00:09<00:12,  2.65batch/s] 38%|███▊      | 19/50 [00:10<00:12,  2.48batch/s] 40%|████      | 20/50 [00:10<00:11,  2.57batch/s] 42%|████▏     | 21/50 [00:10<00:10,  2.65batch/s] 44%|████▍     | 22/50 [00:11<00:10,  2.67batch/s] 46%|████▌     | 23/50 [00:11<00:10,  2.64batch/s] 48%|████▊     | 24/50 [00:12<00:10,  2.41batch/s] 50%|█████     | 25/50 [00:12<00:10,  2.32batch/s] 52%|█████▏    | 26/50 [00:13<00:10,  2.29batch/s] 54%|█████▍    | 27/50 [00:13<00:10,  2.25batch/s] 56%|█████▌    | 28/50 [00:13<00:09,  2.38batch/s] 58%|█████▊    | 29/50 [00:14<00:09,  2.28batch/s] 60%|██████    | 30/50 [00:14<00:08,  2.38batch/s] 62%|██████▏   | 31/50 [00:15<00:07,  2.45batch/s] 64%|██████▍   | 32/50 [00:15<00:07,  2.50batch/s] 66%|██████▌   | 33/50 [00:15<00:06,  2.55batch/s] 68%|██████▊   | 34/50 [00:16<00:06,  2.59batch/s] 70%|███████   | 35/50 [00:16<00:05,  2.60batch/s] 72%|███████▏  | 36/50 [00:16<00:05,  2.63batch/s] 74%|███████▍  | 37/50 [00:17<00:04,  2.68batch/s] 76%|███████▌  | 38/50 [00:17<00:04,  2.70batch/s] 78%|███████▊  | 39/50 [00:18<00:04,  2.54batch/s] 80%|████████  | 40/50 [00:18<00:04,  2.37batch/s] 82%|████████▏ | 41/50 [00:19<00:03,  2.43batch/s] 84%|████████▍ | 42/50 [00:19<00:03,  2.53batch/s] 86%|████████▌ | 43/50 [00:19<00:02,  2.57batch/s] 88%|████████▊ | 44/50 [00:20<00:02,  2.65batch/s] 90%|█████████ | 45/50 [00:20<00:01,  2.67batch/s] 92%|█████████▏| 46/50 [00:20<00:01,  2.70batch/s] 94%|█████████▍| 47/50 [00:21<00:01,  2.52batch/s] 96%|█████████▌| 48/50 [00:21<00:00,  2.61batch/s] 98%|█████████▊| 49/50 [00:22<00:00,  2.63batch/s]100%|██████████| 50/50 [00:22<00:00,  2.69batch/s]100%|██████████| 50/50 [00:22<00:00,  2.24batch/s]
Avg. Dice (ACDC): 0.19356215000152588
Xtr = 1
Baseline (U-Net)
  0%|          | 0/50 [00:00<?, ?batch/s]  2%|▏         | 1/50 [00:00<00:18,  2.69batch/s]  4%|▍         | 2/50 [00:00<00:17,  2.81batch/s]  6%|▌         | 3/50 [00:01<00:16,  2.78batch/s]  8%|▊         | 4/50 [00:01<00:16,  2.77batch/s] 10%|█         | 5/50 [00:01<00:16,  2.79batch/s] 12%|█▏        | 6/50 [00:02<00:15,  2.78batch/s] 14%|█▍        | 7/50 [00:02<00:15,  2.79batch/s] 16%|█▌        | 8/50 [00:02<00:15,  2.78batch/s] 18%|█▊        | 9/50 [00:03<00:14,  2.81batch/s] 20%|██        | 10/50 [00:03<00:14,  2.79batch/s] 22%|██▏       | 11/50 [00:03<00:13,  2.84batch/s] 24%|██▍       | 12/50 [00:04<00:13,  2.80batch/s] 26%|██▌       | 13/50 [00:04<00:13,  2.74batch/s] 28%|██▊       | 14/50 [00:05<00:13,  2.69batch/s] 30%|███       | 15/50 [00:05<00:13,  2.66batch/s] 32%|███▏      | 16/50 [00:05<00:12,  2.67batch/s] 34%|███▍      | 17/50 [00:06<00:12,  2.66batch/s] 36%|███▌      | 18/50 [00:06<00:11,  2.67batch/s] 38%|███▊      | 19/50 [00:07<00:12,  2.55batch/s] 40%|████      | 20/50 [00:07<00:11,  2.62batch/s] 42%|████▏     | 21/50 [00:07<00:10,  2.68batch/s] 44%|████▍     | 22/50 [00:08<00:10,  2.70batch/s] 46%|████▌     | 23/50 [00:08<00:09,  2.74batch/s] 48%|████▊     | 24/50 [00:08<00:10,  2.53batch/s] 50%|█████     | 25/50 [00:09<00:10,  2.46batch/s] 52%|█████▏    | 26/50 [00:09<00:09,  2.45batch/s] 54%|█████▍    | 27/50 [00:10<00:09,  2.39batch/s] 56%|█████▌    | 28/50 [00:10<00:08,  2.50batch/s] 58%|█████▊    | 29/50 [00:10<00:08,  2.43batch/s] 60%|██████    | 30/50 [00:11<00:07,  2.50batch/s] 62%|██████▏   | 31/50 [00:11<00:07,  2.54batch/s] 64%|██████▍   | 32/50 [00:12<00:06,  2.58batch/s] 66%|██████▌   | 33/50 [00:12<00:06,  2.60batch/s] 68%|██████▊   | 34/50 [00:12<00:06,  2.64batch/s] 70%|███████   | 35/50 [00:13<00:05,  2.65batch/s] 72%|███████▏  | 36/50 [00:13<00:05,  2.65batch/s] 74%|███████▍  | 37/50 [00:13<00:04,  2.68batch/s] 76%|███████▌  | 38/50 [00:14<00:04,  2.69batch/s] 78%|███████▊  | 39/50 [00:14<00:04,  2.53batch/s] 80%|████████  | 40/50 [00:15<00:04,  2.40batch/s] 82%|████████▏ | 41/50 [00:15<00:03,  2.49batch/s] 84%|████████▍ | 42/50 [00:15<00:03,  2.59batch/s] 86%|████████▌ | 43/50 [00:16<00:02,  2.61batch/s] 88%|████████▊ | 44/50 [00:16<00:02,  2.67batch/s] 90%|█████████ | 45/50 [00:17<00:01,  2.69batch/s] 92%|█████████▏| 46/50 [00:17<00:01,  2.70batch/s] 94%|█████████▍| 47/50 [00:17<00:01,  2.59batch/s] 96%|█████████▌| 48/50 [00:18<00:00,  2.67batch/s] 98%|█████████▊| 49/50 [00:18<00:00,  2.68batch/s]100%|██████████| 50/50 [00:18<00:00,  2.73batch/s]100%|██████████| 50/50 [00:18<00:00,  2.64batch/s]
Avg. Dice (ACDC): 0.3573540449142456
Proposed (only Linear-probing)
  0%|          | 0/50 [00:00<?, ?batch/s]  2%|▏         | 1/50 [00:00<00:18,  2.66batch/s]  4%|▍         | 2/50 [00:00<00:17,  2.78batch/s]  6%|▌         | 3/50 [00:01<00:17,  2.76batch/s]  8%|▊         | 4/50 [00:01<00:16,  2.77batch/s] 10%|█         | 5/50 [00:01<00:16,  2.78batch/s] 12%|█▏        | 6/50 [00:02<00:15,  2.76batch/s] 14%|█▍        | 7/50 [00:02<00:15,  2.78batch/s] 16%|█▌        | 8/50 [00:02<00:15,  2.77batch/s] 18%|█▊        | 9/50 [00:03<00:14,  2.79batch/s] 20%|██        | 10/50 [00:03<00:14,  2.79batch/s] 22%|██▏       | 11/50 [00:03<00:13,  2.84batch/s] 24%|██▍       | 12/50 [00:04<00:13,  2.79batch/s] 26%|██▌       | 13/50 [00:04<00:13,  2.75batch/s] 28%|██▊       | 14/50 [00:05<00:13,  2.72batch/s] 30%|███       | 15/50 [00:05<00:12,  2.71batch/s] 32%|███▏      | 16/50 [00:05<00:12,  2.73batch/s] 34%|███▍      | 17/50 [00:06<00:12,  2.71batch/s] 36%|███▌      | 18/50 [00:06<00:11,  2.71batch/s] 38%|███▊      | 19/50 [00:06<00:11,  2.59batch/s] 40%|████      | 20/50 [00:07<00:11,  2.65batch/s] 42%|████▏     | 21/50 [00:07<00:10,  2.69batch/s] 44%|████▍     | 22/50 [00:08<00:10,  2.70batch/s] 46%|████▌     | 23/50 [00:08<00:09,  2.77batch/s] 48%|████▊     | 24/50 [00:08<00:10,  2.54batch/s] 50%|█████     | 25/50 [00:09<00:10,  2.46batch/s] 52%|█████▏    | 26/50 [00:09<00:09,  2.45batch/s] 54%|█████▍    | 27/50 [00:10<00:09,  2.39batch/s] 56%|█████▌    | 28/50 [00:10<00:08,  2.48batch/s] 58%|█████▊    | 29/50 [00:10<00:08,  2.41batch/s] 60%|██████    | 30/50 [00:11<00:08,  2.49batch/s] 62%|██████▏   | 31/50 [00:11<00:07,  2.54batch/s] 64%|██████▍   | 32/50 [00:12<00:07,  2.57batch/s] 66%|██████▌   | 33/50 [00:12<00:06,  2.60batch/s] 68%|██████▊   | 34/50 [00:12<00:06,  2.64batch/s] 70%|███████   | 35/50 [00:13<00:05,  2.64batch/s] 72%|███████▏  | 36/50 [00:13<00:05,  2.65batch/s] 74%|███████▍  | 37/50 [00:13<00:04,  2.69batch/s] 76%|███████▌  | 38/50 [00:14<00:04,  2.70batch/s] 78%|███████▊  | 39/50 [00:14<00:04,  2.59batch/s] 80%|████████  | 40/50 [00:15<00:04,  2.44batch/s] 82%|████████▏ | 41/50 [00:15<00:03,  2.53batch/s] 84%|████████▍ | 42/50 [00:15<00:03,  2.62batch/s] 86%|████████▌ | 43/50 [00:16<00:02,  2.63batch/s] 88%|████████▊ | 44/50 [00:16<00:02,  2.69batch/s] 90%|█████████ | 45/50 [00:16<00:01,  2.70batch/s] 92%|█████████▏| 46/50 [00:17<00:01,  2.72batch/s] 94%|█████████▍| 47/50 [00:17<00:01,  2.60batch/s] 96%|█████████▌| 48/50 [00:18<00:00,  2.68batch/s] 98%|█████████▊| 49/50 [00:18<00:00,  2.67batch/s]100%|██████████| 50/50 [00:18<00:00,  2.72batch/s]100%|██████████| 50/50 [00:18<00:00,  2.65batch/s]
Avg. Dice (ACDC): 0.8622574806213379
Proposed
  0%|          | 0/50 [00:00<?, ?batch/s]  2%|▏         | 1/50 [00:00<00:18,  2.68batch/s]  4%|▍         | 2/50 [00:00<00:17,  2.81batch/s]  6%|▌         | 3/50 [00:01<00:16,  2.78batch/s]  8%|▊         | 4/50 [00:01<00:16,  2.78batch/s] 10%|█         | 5/50 [00:01<00:16,  2.79batch/s] 12%|█▏        | 6/50 [00:02<00:15,  2.77batch/s] 14%|█▍        | 7/50 [00:02<00:15,  2.77batch/s] 16%|█▌        | 8/50 [00:02<00:15,  2.76batch/s] 18%|█▊        | 9/50 [00:03<00:14,  2.79batch/s] 20%|██        | 10/50 [00:03<00:14,  2.79batch/s] 22%|██▏       | 11/50 [00:03<00:13,  2.84batch/s] 24%|██▍       | 12/50 [00:04<00:13,  2.80batch/s] 26%|██▌       | 13/50 [00:04<00:13,  2.76batch/s] 28%|██▊       | 14/50 [00:05<00:13,  2.73batch/s] 30%|███       | 15/50 [00:05<00:12,  2.72batch/s] 32%|███▏      | 16/50 [00:05<00:12,  2.74batch/s] 34%|███▍      | 17/50 [00:06<00:12,  2.72batch/s] 36%|███▌      | 18/50 [00:06<00:11,  2.72batch/s] 38%|███▊      | 19/50 [00:06<00:11,  2.59batch/s] 40%|████      | 20/50 [00:07<00:11,  2.65batch/s] 42%|████▏     | 21/50 [00:07<00:10,  2.70batch/s] 44%|████▍     | 22/50 [00:08<00:10,  2.71batch/s] 46%|████▌     | 23/50 [00:08<00:09,  2.75batch/s] 48%|████▊     | 24/50 [00:08<00:10,  2.54batch/s] 50%|█████     | 25/50 [00:09<00:10,  2.45batch/s] 52%|█████▏    | 26/50 [00:09<00:09,  2.45batch/s] 54%|█████▍    | 27/50 [00:10<00:09,  2.39batch/s] 56%|█████▌    | 28/50 [00:10<00:08,  2.49batch/s] 58%|█████▊    | 29/50 [00:10<00:08,  2.41batch/s] 60%|██████    | 30/50 [00:11<00:08,  2.48batch/s] 62%|██████▏   | 31/50 [00:11<00:07,  2.52batch/s] 64%|██████▍   | 32/50 [00:12<00:07,  2.57batch/s] 66%|██████▌   | 33/50 [00:12<00:06,  2.60batch/s] 68%|██████▊   | 34/50 [00:12<00:06,  2.65batch/s] 70%|███████   | 35/50 [00:13<00:05,  2.65batch/s] 72%|███████▏  | 36/50 [00:13<00:05,  2.65batch/s] 74%|███████▍  | 37/50 [00:13<00:04,  2.70batch/s] 76%|███████▌  | 38/50 [00:14<00:04,  2.71batch/s] 78%|███████▊  | 39/50 [00:14<00:04,  2.59batch/s] 80%|████████  | 40/50 [00:15<00:04,  2.44batch/s] 82%|████████▏ | 41/50 [00:15<00:03,  2.52batch/s] 84%|████████▍ | 42/50 [00:15<00:03,  2.59batch/s] 86%|████████▌ | 43/50 [00:16<00:02,  2.61batch/s] 88%|████████▊ | 44/50 [00:16<00:02,  2.67batch/s] 90%|█████████ | 45/50 [00:16<00:01,  2.69batch/s] 92%|█████████▏| 46/50 [00:17<00:01,  2.69batch/s] 94%|█████████▍| 47/50 [00:17<00:01,  2.58batch/s] 96%|█████████▌| 48/50 [00:18<00:00,  2.65batch/s] 98%|█████████▊| 49/50 [00:18<00:00,  2.67batch/s]100%|██████████| 50/50 [00:18<00:00,  2.70batch/s]100%|██████████| 50/50 [00:18<00:00,  2.65batch/s]
Avg. Dice (ACDC): 0.8229348063468933
Xtr = 2
Baseline (U-Net)
Traceback (most recent call last):
  File "/users/nfs/Etu9/21413629/pix2rep/scripts/test_pix2rep.py", line 65, in <module>
    cl_model.load_backbone_model(cfg.contrastive_pretraining.save_path_backbone.split(".")[0]+f"_bl_{k}.pth")
  File "/users/nfs/Etu9/21413629/pix2rep/pix2rep/CL_model.py", line 76, in load_backbone_model
    self.model.load_state_dict(torch.load(weights_load_path))
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/nfs/Etu9/21413629/pix2rep_env/lib/python3.11/site-packages/torch/serialization.py", line 1484, in load
    with _open_file_like(f, "rb") as opened_file:
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/nfs/Etu9/21413629/pix2rep_env/lib/python3.11/site-packages/torch/serialization.py", line 759, in _open_file_like
    return _open_file(name_or_buffer, mode)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/nfs/Etu9/21413629/pix2rep_env/lib/python3.11/site-packages/torch/serialization.py", line 740, in __init__
    super().__init__(open(name, mode))
                     ^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] Aucun fichier ou dossier de ce type: 'hanyu/test1/weights_backbone_CL_best_model_bl_2.pth'
